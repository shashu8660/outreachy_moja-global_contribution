<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FLINT Installation Guide</title>
</head>
<body>
    <h1>How to install FLINT on your local system:</h1>

    <h2>Windows Installation:</h2>

    <p><strong>Prerequisites before installing FLINT:</strong></p>
    <ol>
        <li>GitHub</li>
        <li>Visual Studio</li>
        <li>CMake</li>
        <li>Docker</li>
    </ol>

    <p>These four are required for your journey of contribution towards moja-global. It's better to install them before cloning FLINT.</p>

    <p>Now that you have all the necessary prerequisites, you can proceed with the Installation.</p>

    <h3>First, we install VCPKG:</h3>

    <p>Using VCPKG, we can install the required libraries.</p>

    <p>Open GitHub on your system and search for moja-global. Then in the moja-global repo (repository), search for the VCPKG repo. In the VCPKG repo, copy the URL of the repo: <a href="https://github.com/moja-global/vcpkg.git">https://github.com/moja-global/vcpkg.git</a></p>

    <p>After copying the VCPKG URL, you need to create a folder to hold the moja-global project.</p>

    <p>So open File Manager and create a folder named "Development" on your local desk.</p>

    <p>Note: Create the folder name exactly as "Development" or you might encounter issues while installing FLINT. For example, all paths used below with "C:\Development\moja-global" need to be modified to match your system's build location of the moja project.</p>

    <p>After creating the "Development" folder, create a sub-folder named "moja-global" in the "Development" folder.</p>

    <p>Then open the moja-global directory in the command prompt (cmd). Make sure you're in the moja-global directory, then clone the VCPKG repo in the moja-global folder using the following command:</p>

    <pre><code>git clone https://github.com/moja-global/vcpkg.git</code></pre>

    <p>This clones the VCPKG into the moja-global folder.</p>

    <p>After that, direct the directory to VCPKG in your command prompt by using:</p>

    <pre><code>cd vcpkg</code></pre>

    <p>To install all files of VCPKG, use the following commands:</p>

    <pre><code>bootstrap-vcpkg.bat</code></pre>

    <p>Wait until it runs successfully. Then install packages using the following commands:</p>

    <pre><code>vcpkg.exe install boost-test:x64-windows boost-program-options:x64-windows boost-log:x64-windows turtle:x64-windows zipper:x64-windows poco:x64-windows libpq:x64-windows gdal:x64-windows sqlite3:x64-windows boost-ublas:x64-windows fmt:x64-windows libpqxx:x64-windows</code></pre>

    <p>Note: It might take up to 1 hour to install all the packages depending on your system's speed.</p>

    <p>After successfully installing packages in the VCPKG folder, redirect the directory to moja-global in your command prompt by using:</p>

    <pre><code>cd..</code></pre>

    <p>Then open the moja-global repo on GitHub and search for the FLINT repo in it. Copy the URL of the FLINT repo: <a href="https://github.com/moja-global/FLINT.git">https://github.com/moja-global/FLINT.git</a></p>

    <p>Then clone the repo in the moja-global folder by command prompt using:</p>

    <pre><code>git clone https://github.com/moja-global/FLINT.git</code></pre>

    <p>After cloning the FLINT repository, switch to the develop branch. Start cmd in the FLINT folder of your system and run the command:</p>

    <pre><code>cd Flint
git checkout develop</code></pre>

    <h3>Using CMake to build the project:</h3>

    <p>Start cmd in your FLINT core repository folder. Now use the following commands to create the Visual Studio solution:</p>

    <p>By changing the directory to source in cmd and creating a new folder build in the source folder by using:</p>

    <pre><code># Create a build folder under the Source folder
cd source
mkdir build
cd build</code></pre>

    <p>Now create the Visual Studio Solution (2019):</p>

    <pre><code>cmake -G "Visual Studio 16 2019" -DCMAKE_INSTALL_PREFIX=..\..\.. -DVCPKG_TARGET_TRIPLET=x64-windows -DENABLE_TESTS=OFF -DENABLE_MOJA.MODULES.ZIPPER=OFF -DCMAKE_TOOLCHAIN_FILE=..\..\..\vcpkg\scripts\buildsystems\vcpkg.cmake ..</code></pre>

    <p>Run this line successfully in cmd.</p>

    <h3>Building the FLINT:</h3>

    <p>Type "moja.sln" in the command prompt. Visual Studio is launched.</p>

    <pre><code>moja.sln</code></pre>

    <p>After Visual Studio has loaded completely, move to the Solution Explorer in the top right, expand the CMakePredefinedTargets and select ALL_BUILD.</p>

    <p>Right-click on ALL_BUILD and click on Build in the menu.</p>

    <p>If the output says "Build 7 succeeded" as shown in the image below, FLINT has built successfully.</p>

    <p>To see the freshly compiled FLINT executable, open the build folder and in the command prompt type:</p>

    <pre><code>cd bin\debug</code></pre>

    <p>Type "moja.cli" in the command prompt:</p>

    <pre><code>moja.cli</code></pre>

    <p>You see the output as:</p>

    <pre><code>moja.cli version.
general option.
command-line only option.
configuration file option.</code></pre>

    <p>If your output has them all then the installation was successful.</p>

      <h2>Flint.example Installation:</h2>

    <p><strong>Flint.example:</strong></p>

    <p>For installing Flint.example:</p>
    <ul>
        <li>First Environment: Visual Studio:</li>
    </ul>

    <p>In the Visual Studio environment option for setting up Flint.example, the options to run, develop, and debug the repository code are available.</p>

    <p>For Flint.example to run, all VCPKG packages should be present in the moja-global folder.</p>

    <p>First go to the moja-global repo on GitHub then search for flint.example. Then in flint.example repo copy the URL of flint.example: <a href="https://github.com/moja-global/FLINT.Example.git">https://github.com/moja-global/FLINT.Example.git</a></p>

    <p>Then in cmd direct toward the moja-global dir then run cmd:</p>

    <pre><code>git clone https://github.com/moja-global/FLINT.Example.git</code></pre>

    <p>To clone the Flint.example in your moja-global folder.</p>

    <p>Next step is to build the Flint.example:</p>

    <p>In the cmd direct dir to Flint.example by:</p>

    <pre><code>cd flint.example</code></pre>

    <p>Create a build folder under the Source folder:</p>

    <pre><code>cd source
mkdir build 
cd build</code></pre>

    <p>Next step is to choose which type of simulation you want to execute.</p>

    <p>You may run one of the following generate commands:</p>

    <ol>
        <li>Commands to run cmake for the point simulations:</li>
    </ol>

    <pre><code># Generate the project files
cmake -G "Visual Studio 16 2019" -DCMAKE_INSTALL_PREFIX=C:\Development\Software\moja -DVCPKG_TARGET_TRIPLET=x64-windows -DOPENSSL_ROOT_DIR=c:\Development\moja-global\vcpkg\installed\x64-windows -DENABLE_TESTS=OFF -DCMAKE_TOOLCHAIN_FILE=c:\Development\moja-global\vcpkg\scripts\buildsystems\vcpkg.cmake ..</code></pre>

    <ol start="2">
        <li>Commands to run cmake for the spatial simulations:</li>
    </ol>

    <pre><code># if you're planning to run spatial chapman richards example you also need to enable the gdal module
# Generate the project files
cmake -G "Visual Studio 16 2019" -DCMAKE_INSTALL_PREFIX=C:\Development\Software\moja -DVCPKG_TARGET_TRIPLET=x64-windows -DOPENSSL_ROOT_DIR=c:\Development\moja-global\vcpkg\installed\x64-windows -DENABLE_TESTS=OFF -DENABLE_MOJA.MODULES.GDAL=ON -DCMAKE_TOOLCHAIN_FILE=c:\Development\moja-global\vcpkg\scripts\buildsystems\vcpkg.cmake ..</code></pre>

    <p>First let's try the point simulations:</p>

    <p>In cmd:</p>

    <pre><code>cmake -G "Visual Studio 16 2019" -DCMAKE_INSTALL_PREFIX=C:\Development\Software\moja -DVCPKG_TARGET_TRIPLET=x64-windows -DOPENSSL_ROOT_DIR=c:\Development\moja-global\vcpkg\installed\x64-windows -DENABLE_TESTS=OFF -DCMAKE_TOOLCHAIN_FILE=c:\Development\moja-global\vcpkg\scripts\buildsystems\vcpkg.cmake ..</code></pre>

    <p>Run it successfully.</p>

    <p>There are two models to test Flint.example which are:</p>

    <ol>
        <li>RothC example</li>
        <li>Chapman Richards example</li>
    </ol>

    <p>First let's try RothC example:</p>

    <p>We also have a RothC example for point level simulations. In order to run this example, you may modify the following arguments in the above test settings command arguments. These arguments will point at the right configuration files for RothC. Please follow the following steps to set the correct configuration -</p>

    <p>Get to flint.example folder from the moja-global folder then in flint.example open source folder then open build folder from source search for flint.example.sln. Open the flint.example.sln in visual studio</p>

    <p>Build the debug configuration ALL_BUILD target by right-clicking the ALL_BUILD node and selecting Build.</p>

    <p>After Build the debug configuration All_BUILD.</p>

    <p>Then right-click the the moja.flint.example.rothc node and select Set as Startup Project then right-click again and select properties. Navigate to Configuration Properties/Debugging properties pane and configure the following:</p>

    <p>First in command edit by click at arrow at right side of the command press edit and edit as:</p>

    <p><strong>Command:</strong></p>

    <pre><code>C:\Development\moja-global\FLINT\Source\build\bin\Debug\moja.cli.exe</code></pre>

    <p>Next, command arguments:</p>

    <p><strong>Command Arguments:</strong></p>

    <pre><code>--config config\point_rothc_example.json --config config\debug\libs.base_rothc.win.json --logging_config logging.debug_on.conf</code></pre>

    <p>Next, edit the working directory:</p>

    <p><strong>Working Directory:</strong></p>

    <pre><code>$(SolutionDir)..\..\Run_Env</code></pre>

    <p>Next, edit the environment:</p>

    <p><strong>Environment:</strong></p>

    <pre><code>PATH=C:\Development\moja-global\vcpkg\installed\x64-windows\debug\bin;C:\Development\moja-global\FLINT\Source\build\bin\$(Configuration);%PATH%
LOCAL_LIBS=$(OutDir)
MOJA_LIBS=C:\Development\moja-global\FLINT\Source\build\bin\$(Configuration)</code></pre>

    <p>After that, apply the change and press OK.</p>

    <p>You should now be able to select <strong>Debug -&gt; Start Debugging</strong> to start a debug run of the RothC example.</p>

    <p>Now you can run the RothC example.</p>

    <h2>Instructions for Chapmans Richards Example:</h2>

    <p>Before running the Chapmans Richards example, we need to set up GDAL.</p>

    <p><strong>Enable moja.modules.GDAL:</strong></p>

    <p>Before moving on to setting up the Chapman Richards model, we need to enable the <code>moja.modules.GDAL</code> flags. We can toggle these flags by clicking on <strong>BROWSE BUILD</strong> and setting it to the build directory where we just built the solution.</p>

    <p>Open the solution that CMake created at <code>C:\Development\moja-global\FLINT\Source\build\moja.sln</code>.</p>

    <p>Check the following flags present:</p>

    <ul>
        <li>ENABLE_MOJA.MODULES.GDAL</li>
        <li>ENABLE_MOJA.MODULES.LIBPQ</li>
        <li>ENABLE_MOJA.MODULES.POCO</li>
        <li>ENABLE_MOJA.MODULES.ZIPPER</li>
    </ul>

    <p>Then click on configure option twice.</p>

    <p>Click on Generate and then you may explore all the enabled modules in Solution Explorer by clicking on Open Project.</p>

    <p>The its opens visual studio then.</p>

    <p>Open CMakePredefinedTargets, right click on ALL_BUILD and click on Build</p>

    <p>Then open environment variables and click on new in the System variables</p>

    <p>And add GDAL_DATA (all in caps) in path add GDAL path from vcpkg :<code>C:\Development\moja-global\vcpkg\installed\x64-windows\share\gdal</code></p>

    <p>Now we are ready to run Chapmans Richards example</p>

    <h3>Chapmans Richards Example:</h3>

    <p>Based on the moja global repository Chapman Richards, this sample can be run on both point and spatial versions (over Dominica)</p>

    <p>Get to flint.example folder from the moja-global folder then in flint.example open source folder then open build folder from source search for flint.example.sln. Open the flint.example.sln in visual studio</p>

    <p>Then right click the the moja.flint.example.Chapmans node and select Set as Startup Project then right click again and select properties.</p>

    <p>Navigate to Configuration Properties/Debugging properties pane and configure the following:</p>
    
    <h3>Edit Command:</h3>
    <p>First, in the command edit, click on the arrow at the right side of the command, then press edit:</p>

    <ul>
        <li><strong>Command:</strong> <code>C:\Development\moja-global\FLINT\Source\build\bin\$(Configuration)\moja.cli.exe</code></li>
    </ul>

    <h3>Edit Command Arguments:</h3>
    <p>Edit the command arguments:</p>

    <ul>
        <li><strong>Command Arguments (Point Version):</strong></li>
        <ul>
            <li><code>--config config/point_forest_config.json --config config/$(Configuration)/libs.gdal.chaprich.win.json</code></li>
        </ul>
        <li><strong>Command Arguments (Spatial Version):</strong></li>
        <ul>
            <li><code>--config config/forest_config.json --config config/$(Configuration)/libs.gdal.chaprich.win.json --config_provider config/forest_provider.json</code></li>
        </ul>
    </ul>

    <h3>Edit Working Directory:</h3>
    <p>Edit the working directory:</p>

    <ul>
        <li><strong>Working Directory:</strong> <code>$(SolutionDir)\..\..\Run_Env</code></li>
    </ul>

    <h3>Edit Environment:</h3>
    <p>Edit the environment:</p>

    <ul>
        <li><strong>Environment:</strong></li>
        <ul>
            <li><code>PATH=C:\Development\moja-global\vcpkg\installed\x64-windows\bin;C:\Development\moja-global\FLINT\Source\build\bin\$(Configuration);%PATH%</code></li>
            <li><code>LOCAL_LIBS=$(OutDir)</code></li>
            <li><code>MOJA_LIBS=C:\Development\moja-global\FLINT\Source\build\bin\$(Configuration)</code></li>
        </ul>
    </ul>

    <p>After making these changes, apply the changes and press OK.</p>

    <p>You should now be able to select <strong>Debug -&gt; Start Debugging</strong> to start a debug run of the Chapmans Richards example.</p>

    <p>Now you can run the Chapmans Richards example.</p>

    <p>Next and last step is to Setup Docker Containers.</p>

    <h2>Setup Docker Container:</h2>

    <p>Containers are a simple way to build FLINT and all required dependencies.</p>

    <h3>Building using Prebuilt Image:</h3>

    <p>Instead of building the required libraries, pre-built Docker Image is available for FLINT at our GitHub Container Registry. You can pull and run FLINT using this prebuilt image using the following commands:</p>

    <ul>
        <li><strong>Pull the image:</strong></li>
        <ul>
            <li><code>docker pull ghcr.io/moja-global/flint.example:master</code></li>
        </ul>
        <li><strong>Run a container:</strong></li>
        <ul>
            <li><code>docker run --rm -ti ghcr.io/moja-global/flint.example:master bash</code></li>
        </ul>
        <li><strong>Run CLI:</strong></li>
        <ul>
            <li><code>moja.cli --help</code></li>
        </ul>
    </ul>

    <p>That's all! Thank you for going through the installation process. If anything is missing, I would like to get feedback.</p>


</body>
</html>
